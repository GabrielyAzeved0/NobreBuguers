<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Teste Planilha</title>
</head>
<body>
  <h2>Teste de envio para Planilha</h2>

  <button id="enviar">Enviar Pedido de Teste</button>
  <p id="resposta"></p>

  <script>
    const btn = document.getElementById("enviar");
    const resposta = document.getElementById("resposta");

    btn.addEventListener("click", async () => {
      try {
        const dados = {
          numeroPedido: "123",
          nome: "Fulano Teste",
          telefone: "12345678",
          bairro: "Centro",
          endereco: "Rua Exemplo, 123",
          itens: "['Item1','Item2']",
          total: "100",
          observacao: "Sem observação",
          dataHora: new Date().toLocaleString()
        };

        const url = "https://script.google.com/macros/s/AKfycby0aBkpwP5HRHwI4fJqQRr77UzNih4kw0QzJNKGkxnhpAWYTpr9kPuPOwLoB8wcddMDpw/exec";

        const params = new URLSearchParams(dados);

        const resp = await fetch(url + "?" + params.toString(), {
          method: "GET",
        });

        const json = await resp.json();
        resposta.textContent = json.msg || "Enviado!";
      } catch (erro) {
        resposta.textContent = "Erro ao enviar: " + erro;
      }
    });
  </script>
</body>
</html>
